<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chauffeur Dashboard</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #00c6ff, #0072ff);
      min-height: 100vh;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background-color: rgba(255, 255, 255, 0.15);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      width: 90%;
      max-width: 600px;
      text-align: center;
    }
    input, button {
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
      border: none;
      width: 100%;
      font-size: 1rem;
    }
    button {
      background-color: #fff;
      color: #0072ff;
      cursor: pointer;
      transition: 0.3s ease;
    }
    button:hover {
      background-color: #0072ff;
      color: #fff;
      transform: scale(1.05);
    }
    #dashboard {
      display: none;
    }
    .ritten-lijst {
      text-align: left;
      margin-top: 20px;
    }
    .rit {
      background: rgba(255, 255, 255, 0.2);
      padding: 10px;
      margin: 10px 0;
      border-radius: 10px;
    }
    .rit button {
      width: auto;
      padding: 8px 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Chauffeur Dashboard</h1>
    <div id="login-form">
      <input type="text" id="login-naam" placeholder="Naam">
      <input type="password" id="login-wachtwoord" placeholder="Wachtwoord">
      <button onclick="login()">Inloggen</button>
      <hr>
      <input type="text" id="reg-naam" placeholder="Nieuwe naam">
      <input type="password" id="reg-wachtwoord" placeholder="Nieuw wachtwoord">
      <button onclick="registreer()">Registreren</button>
    </div>

    <div id="dashboard">
      <p>Welkom, <span id="chauffeurNaam"></span>!</p>
      <p>Locatie: <span id="adres"></span></p>
      <div class="ritten-lijst" id="ritten">
        <h3>Beschikbare ritten:</h3>
        <div class="rit">
          <p><strong>Ophaaladres:</strong> Stationsplein 1, Rotterdam</p>
          <p><strong>Bestemming:</strong> Erasmusbrug, Rotterdam</p>
          <button onclick="accepteerRit('rit1')">Accepteer</button>
        </div>
        <div class="rit">
          <p><strong>Ophaaladres:</strong> Coolsingel 5, Rotterdam</p>
          <p><strong>Bestemming:</strong> Ahoyweg 10, Rotterdam</p>
          <button onclick="accepteerRit('rit2')">Accepteer</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const apiKey = '5b3ce3597851110001cf6248b59dc263cab24bdabda48748cd9122b3';

    function registreer() {
      const naam = document.getElementById('reg-naam').value;
      const wachtwoord = document.getElementById('reg-wachtwoord').value;

      fetch('/registreer', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ naam, wachtwoord })
      })
      .then(res => res.json())
      .then(data => alert(data.message))
      .catch(() => alert('Fout bij registratie.'));
    }

    function login() {
      const naam = document.getElementById('login-naam').value;
      const wachtwoord = document.getElementById('login-wachtwoord').value;

      fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ naam, wachtwoord })
      })
      .then(res => {
        if (!res.ok) throw new Error('Fout');
        return res.json();
      })
      .then(data => {
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('chauffeurNaam').innerText = naam;
        locatieOphalen();
      })
      .catch(() => alert('Inloggen mislukt.'));
    }

    function locatieOphalen() {
      if (!navigator.geolocation) return alert('Locatie niet ondersteund.');
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude, longitude } = pos.coords;
        const response = await fetch(`https://api.openrouteservice.org/geocode/reverse?api_key=${apiKey}&point.lat=${latitude}&point.lon=${longitude}`);
        const data = await response.json();
        const adres = data.features[0]?.properties?.label || 'Onbekend adres';
        document.getElementById('adres').innerText = adres;
      }, () => {
        alert('Kon locatie niet ophalen.');
      });
    }

    function accepteerRit(ritId) {
      alert(`Rit ${ritId} geaccepteerd!`);
    }
  </script>
</body>
</html>
